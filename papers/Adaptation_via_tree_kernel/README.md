# 在消费意图识别任务上的基于树核最大平均差异的领域自适应
论文名：Domain Adaptation via Tree Kernel Based Maximum Mean Discrepancy for User Consumption Intention Identification  
作者：丁效，蔡碧波，刘挺，石乾坤  
## 背景
### 消费意图识别
人们在社交媒体上面发表的一些动态称为社会媒体信息，其中有一部分信息可以显式或者隐式的表达人们购买某种商品的倾向，这种倾向称为消费一图。
例如：“今晚想去看年少的你”，这句话表明可能发表者有想要去看电影的倾向。表1中举出了一些表达不同领域的消费意图的例子。消费意图识别的任务
具有领域相关的特性[2]，一个针对A领域（如购买电影票）训练出的模型，如果用来判别其他领域的数据（如购买手机）中是否包含了消费意图，模型的
表现往往较差。所以在消费意图识别的任务上，如何进行领域自适应成了一个值得研究的问题。  
![da1](https://github.com/opprash/braveRL/blob/master/datas/da1.png)  
### 领域自适应
领域自适应(domain adaptation)是迁移学习(transfer learning)的研究内容之一。其遵循了迁移学习问题的基本设定，即源领域和目标领域不同的领域
并且仅有源领域包含丰富的监督信息。特征如下：
* 特征空间一致
* 类别空间一致
* 特征分布不一致  
该问题的目标是通过最大限度的利用有限的源领域来辅助目标领域的训练，使得即使在弱监督或者无监督的情况下，在目标领域仍能取得很好的效果
，这其中，需要解决两个问题，一个是如何进行领域之间分布差异的度量，另一个是如何学到更有效的领域之间的迁移特征，即领域不变量。这里通常使用的方是
最大平局差异(MMD)，这个公式很有效。  
![da10](https://github.com/opprash/braveRL/blob/master/datas/da10.png)  
MMD是一种双样本检验的方法，当结果为0时表示两个样本服从同样的分布。其中是函数$Φ$映射，代表将原向量映射到高维的西伯尔空间中去。  
对于如何更有效的学习到领域不变量的问题，最近的研究表明深度神经网络具有良好的可迁移性。但是，在神经网络的一层一层前向传播的过程中，学习到的特征的
可迁移性将会逐渐变差。故对于神经网络末端的领域私有层，需要使用小部分的目标领域的有标注数据进行finetune以达到较好的效果。  
在本文中，作者提出了基于核树最大平均差异的领域自适应的消费意图识别模型来解决上述两个问题，在MMD中样本的检验效果取决于核的选取
这里使用广泛运用于nlp任务中的基于核树的方法来进行领域差异的度量。。除此之外作者还使用了Tree-Lstm捕捉特征。
## 模型介绍
![da3](https://github.com/opprash/braveRL/blob/master/datas/da3.png)  
如图１所示，作者小使用有标注的数据训练得到有标注的模型１，损失函数如下：  
![da4](https://github.com/opprash/braveRL/blob/master/datas/da4.png)  
作者希望模型１能够获得尽可能高的准确率来帮助后续的目标领域的训练但是，由于模型学习到的特征具有领域独立性，故模型1不能直接用于目标
领域数据的预测。因此作者将模型1的Tree-lstm层的参数作为模型2的预训练的参数。模型2即为最终对目标领域数据进行分类的模型。以此
期望随着训练轮数的增加，源域和目标域的数据经Tree-lstm变化得到的特征的分布能够越来越相近。这可以通过对上式添加TK-MMD函数来实现。  
![da5](https://github.com/opprash/braveRL/blob/master/datas/da5.png)  
## 实验结果
### 数据集
数据集中包含了5个领域，分别是订火车票，订飞机票，买手机，买电脑，买电影票，其训练集，验证集，和测试集。这些数据随后将会公开。
数据集的相关细节如表2所示。　　
![da6](https://github.com/opprash/braveRL/blob/master/datas/lan/da6.png)  
### 实验结果
![da7](https://github.com/opprash/braveRL/blob/master/datas/da7.png)  
